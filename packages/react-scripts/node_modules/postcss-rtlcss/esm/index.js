import e from"postcss";import r from"rtlcss";var o,t,n,i=function(){return i=Object.assign||function(e){for(var r,o=1,t=arguments.length;o<t;o++)for(var n in r=arguments[o])Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e},i.apply(this,arguments)};function a(e,r,o){if(o||2===arguments.length)for(var t,n=0,i=r.length;n<i;n++)!t&&n in r||(t||(t=Array.prototype.slice.call(r,0,n)),t[n]=r[n]);return e.concat(t||Array.prototype.slice.call(r))}!function(e){e.combined="combined",e.override="override",e.diff="diff"}(o||(o={})),function(e){e.ltr="ltr",e.rtl="rtl"}(t||(t={})),function(e){e.disabled="disabled",e.flexible="flexible",e.strict="strict"}(n||(n={}));var s,l,d=/rtl:/,c=/rtl:ignore/,u=/^\/\*!? *rtl:?(begin|end)?:(\w+):?([^*]*?) *\*\/$/,f=/(right|left)/i,p=/^(html)(?=\W|$)/,m=/(:root)(?=\W|$)/,b=/[.?*+^$[\]\\(){}|-]/g,g=/\w$/;!function(e){e.IGNORE="ignore",e.RENAME="rename",e.SOURCE="source",e.RAW="raw"}(s||(s={})),function(e){e.BEGIN="begin",e.END="end"}(l||(l={}));var v=new RegExp("$-^"),h=[{name:"left-right",search:["left","Left","LEFT"],replace:["right","Right","RIGHT"]},{name:"ltr-rtl",search:["ltr","Ltr","LTR"],replace:["rtl","Rtl","RTL"]}],y=function(e){if(e.name)return e.name;var r=Array.isArray(e.search)?e.search[0]:e.search,o=Array.isArray(e.replace)?e.replace[0]:e.replace,t=/[^\w]/g;return r.replace(t,"-")+"-"+o.replace(t,"_")},R=function(e){return e.map((function(e){return{name:y(e),priority:100,search:e.search,replace:e.replace,options:{scope:"*",ignoreCase:!1}}}))},k=Object.keys(o).map((function(e){return o[e]})),E=Object.keys(t).map((function(e){return t[e]})),x=Object.keys(n).map((function(e){return n[e]})),w=function(e){return"string"!=typeof e&&!Array.isArray(e)||!!Array.isArray(e)&&e.some((function(e){return"string"!=typeof e}))},P=function(e,r){return"string"==typeof r?a(a([],e,!0),[r],!1):a(a([],e,!0),r,!0)},A=function(){return{mode:o.combined,ltrPrefix:'[dir="ltr"]',rtlPrefix:'[dir="rtl"]',bothPrefix:"[dir]",safeBothPrefix:!1,ignorePrefixedRules:!0,source:t.ltr,processUrls:!1,processKeyFrames:!1,processEnv:!0,useCalc:!1,stringMap:R(h),autoRename:n.disabled,greedy:!1,aliases:{}}},O={options:i({},A()),keyframes:[],keyframesToRemove:[],keyframesStringMap:{},keyframesRegExp:v,rules:[],rulesAutoRename:[],rulesToRemove:[],rulesPrefixRegExp:v},T=function(e){var r,o=i({},A());(e.mode&&k.includes(e.mode)&&(o.mode=e.mode),e.source&&E.includes(e.source)&&(o.source=e.source),e.autoRename&&x.includes(e.autoRename)&&(o.autoRename=e.autoRename),"boolean"==typeof e.ignorePrefixedRules&&(o.ignorePrefixedRules=e.ignorePrefixedRules),"boolean"==typeof e.greedy&&(o.greedy=e.greedy),w(e.ltrPrefix)||(o.ltrPrefix=e.ltrPrefix),w(e.rtlPrefix)||(o.rtlPrefix=e.rtlPrefix),w(e.bothPrefix)||(o.bothPrefix=e.bothPrefix),"boolean"==typeof e.safeBothPrefix&&(o.safeBothPrefix=e.safeBothPrefix),"boolean"==typeof e.processUrls&&(o.processUrls=e.processUrls),"boolean"==typeof e.processKeyFrames&&(o.processKeyFrames=e.processKeyFrames),"boolean"==typeof e.processEnv&&(o.processEnv=e.processEnv),"boolean"==typeof e.useCalc&&(o.useCalc=e.useCalc),function(e){return!Array.isArray(e)||e.some((function(e){return typeof e.search!=typeof e.replace||w(e.search)||w(e.replace)||Array.isArray(e.search)&&Array.isArray(e.replace)&&e.search.length!==e.replace.length}))}(e.stringMap))||R(e.stringMap).forEach((function(e){e.name===h[0].name?o.stringMap.splice(0,1,e):e.name===h[1].name?o.stringMap.splice(1,1,e):o.stringMap.push(e)}));return e.aliases&&(r=e.aliases,!Object.entries(r).some((function(e){return"string"!=typeof e[1]})))&&(o.aliases=e.aliases),o},M=function(e){O.options=T(e),O.keyframes=[],O.keyframesToRemove=[],O.keyframesStringMap={},O.keyframesRegExp=v,O.rules=[],O.rulesAutoRename=[],O.rulesToRemove=[],O.rulesPrefixRegExp=function(e){var r=e.ltrPrefix,o=e.rtlPrefix,t=e.bothPrefix;if(!e.ignorePrefixedRules)return v;var n=[];return n=P(n,r),n=P(n,o),n=(n=P(n,t)).map((function(e){var r=e.replace(b,"\\$&");return g.test(e)?r+"(?:\\W|$)":r})),new RegExp("("+n.join("|")+")")}(O.options)},j=function(){var e,r;O.keyframesStringMap=(e=O.keyframes,r={},e.forEach((function(e){r[e.atRuleParams]={name:e.atRule.params,nameFlipped:e.atRuleFlipped.params}})),r),O.keyframesRegExp=function(e){return new RegExp("(^|[^\\w-]| )("+Object.keys(e).join("|")+")( |[^\\w-]|$)","g")}(O.keyframesStringMap)},N=Object.values(s),S=Object.values(l),I=function(e){var r=e.toString().match(u);if(r&&function(e){return N.includes(""+e[2])&&(void 0===e[1]||S.includes(""+e[1]))}(r)){var o={directive:r[2]};return r[1]&&(o.block=r[1]),r[3]&&(o.option=r[3]),o}return null},C=function(e,r){return e.directive===s.IGNORE&&!e.block&&r[s.IGNORE]&&r[s.IGNORE].block===l.BEGIN},F=function(e,r){var o=e[r];if(o){var t=o.block;if(t!==l.BEGIN&&delete e[r],t!==l.END)return!0}return!1},G=function(e,r){var o=e[s.SOURCE],t=F(e,s.SOURCE);return o&&t?o.option:r||void 0},B=function(e,r,o,t){e.each((function(e){if("comment"===e.type||r.includes(e.type))if("comment"===e.type){var n=e,i=I(n);i&&o(n,i)}else t(e)}))},L=/^-\w+-/,U=function(e){return e.replace(L,"")},$=function(e,r){return p.test(r)?r.replace(p,"$1"+e):m.test(r)?r.replace(m,e+"$1"):e+" "+r},W=function(e,r){e.selectors="string"==typeof r?e.selectors.map((function(e){return O.rulesPrefixRegExp.test(e)?e:$(r,e)})):e.selectors.reduce((function(e,o){return e=O.rulesPrefixRegExp.test(o)?a(a([],e,!0),[o],!1):e.concat(r.map((function(e){return $(e,o)})))}),[])},K=function(e){return!!e.selectors.find((function(e){return O.rulesPrefixRegExp.test(e)}))},D=function(e){return e.some((function(e){return"decl"===e.type||"rule"===e.type&&D(e)||"atrule"===e.type&&D(e)}))},z=function(e,r,o){if(function(e){return e.some((function(e){return"decl"===e.type}))}(r)){var t;for(o=a([],o,!0);o.length;){t=o.shift();var n=e.nodes.find((function(e){if("rule"===e.type&&e.selector===t.selector)return!0}));n?t=n:(t=t.clone().removeAll(),e.append(t)),e=t}e.append(r)}},H=function(e,r,n,i,a){var s={rule:e,ruleLTR:r,ruleRTL:n,ruleBoth:i,ruleSafe:a};return O.options.mode!==o.diff&&function(e,r,n,i){var a=O.options,s=a.mode,l=a.ltrPrefix,d=a.rtlPrefix,c=a.bothPrefix,u=a.source;s===o.combined?(W(e,u===t.ltr?l:d),W(r,u===t.rtl?l:d)):(W(e,u===t.ltr?d:l),W(r,u===t.rtl?d:l)),W(n,c),W(i,c)}(r,n,i,a),O.rules.push(s),s},_=function(e,r,o,t,n){var i=function(e){for(var r=[];"rule"===e.type;)r.push(e),e=e.parent;return r.shift(),r.reverse()}(e),a=i.shift(),s=O.rules.find((function(e){return e.rule===a}));if(!s){var l=a.clone().removeAll(),d=l.clone(),c=l.clone(),u=l.clone();s=H(a,l,d,c,u)}!function(e,r,o,t,n,i){z(n.ruleLTR,e,i),z(n.ruleRTL,r,i),z(n.ruleBoth,o,i),z(n.ruleSafe,t,i)}(r,o,t,n,s,i)},q=function(e,r){void 0===r&&(r="\n\n"),!e||"rule"!==e.type&&"atrule"!==e.type||(e.raws.before=""+r+(e.raws.before?e.raws.before.replace(/\n/g,""):""))},J=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];e.forEach((function(e){var r=e.prev();r&&"comment"!==r.type&&q(e),e.walk((function(e){if("decl"===e.type){var r=e;r.raws&&r.raws.value&&d.test(r.raws.value.raw)&&(delete r.raws.value,r.value=r.value.trim())}}))}))},Q=function(e){D(e)?e.walkRules((function(e){Q(e),D(e)||e.remove()})):e.remove()},V={animation:{overridden:null,overrides:["animation-direction","animation-duration","animation-delay","animation-name","animation-fill-mode","animation-iteration-count","animation-play-state","animation-timing-function"]},background:{overridden:null,overrides:["background-attachment","background-clip","background-color","background-image","background-repeat","background-size"]},"background-position":{overridden:"background",overrides:["background-position-x","background-position-y"]},border:{overridden:null,overrides:[]},"border-bottom":{overridden:"border",overrides:["border-bottom-color","border-bottom-style","border-bottom-width"]},"border-left":{overridden:"border",overrides:["border-left-color","border-left-style","border-left-width"]},"border-right":{overridden:"border",overrides:["border-right-color","border-right-style","border-right-width"]},"border-top":{overridden:"border",overrides:["border-top-color","border-top-style","border-top-width"]},"border-color":{overridden:"border",overrides:["border-bottom-color","border-left-color","border-right-color","border-top-color"]},"border-style":{overridden:"border",overrides:["border-bottom-style","border-left-style","border-right-style","border-top-style"]},"border-width":{overridden:"border",overrides:["border-bottom-width","border-left-width","border-right-width","border-top-width"]},"border-radius":{overridden:null,overrides:["border-bottom-left-radius","border-bottom-right-radius","border-top-left-radius","border-top-right-radius"]},margin:{overridden:null,overrides:["margin-bottom","margin-left","margin-top","margin-right"]},padding:{overridden:null,overrides:["padding-bottom","padding-left","padding-top","padding-right"]},transition:{overridden:null,overrides:["transition-delay","transition-duration","transition-property","transition-timing-function"]}},X=["box-shadow","clear","cursor","direction","float","left","right","text-align","text-align-last","text-shadow","transform","transform-origin"],Y={0:["border-bottom-right-radius","border-bottom-left-radius","border-end-end-radius","border-end-start-radius","border-start-end-radius","border-start-start-radius","border-top-left-radius","border-top-right-radius","margin-block-end","margin-block-start","margin-top","margin-right","margin-bottom","margin-left","margin-inline-end","margin-inline-start","padding-block-end","padding-block-start","padding-top","padding-right","padding-bottom","padding-left","padding-inline-end","padding-inline-start","scroll-margin-block-end","scroll-margin-block-start","scroll-margin-top","scroll-margin-right","scroll-margin-bottom","scroll-margin-left","scroll-margin-inline-end","scroll-margin-inline-start"],auto:["top","right","bottom","left","grid-column-end","grid-column-start","grid-row-end","grid-row-start","inset-block-end","inset-block-start","inset-inline-end","inset-inline-start","scroll-padding-block-end","scroll-padding-block-start","scroll-padding-top","scroll-padding-right","scroll-padding-bottom","scroll-padding-left","scroll-padding-inline-end","scroll-padding-inline-start"],currentcolor:["border-block-start-color","border-block-end-color","border-top-color","border-right-color","border-bottom-color","border-left-color","border-inline-start-color","border-inline-end-color"],medium:["border-block-start-width","border-block-end-width","border-top-width","border-right-width","border-bottom-width","border-left-width","border-inline-start-width","border-inline-end-width"],none:["border-block-start","border-block-end","border-top","border-right","border-bottom","border-left","border-top-style","border-right-style","border-bottom-style","border-left-style","border-block-start-style","border-block-end-style","border-inline-start","border-inline-end","border-inline-start-style","border-inline-end-style"]},Z={},ee={},re={},oe=function(e){var r=V[e].overridden;return r?[r].concat(oe(r)):[]};Object.keys(V).forEach((function(e){var r=oe(e);Z[e]=r,V[e].overrides.forEach((function(o){Z[o]=[e].concat(r)}))})),Object.assign(ee,Z),X.forEach((function(e){ee[e]=[]})),Object.keys(Y).forEach((function(e){Y[e].forEach((function(r){re[r]=e}))}));var te=function(e,r){var o=e.clone(),t=e.prev();if(t&&"comment"===t.type){var n=t.clone();r.append(n),t.remove()}r.append(o)},ne=function(e){var r=!!e.raws&&!!e.raws.value&&e.raws.value.raw;return!(!r||!c.test(r))},ie=function(t,i,a,l){void 0===l&&(l=!1);var d=O.options,c=d.mode,u=d.source,p=d.safeBothPrefix,m=d.processUrls,b=d.processEnv,g=d.useCalc,v=d.stringMap,h=d.autoRename,y=d.greedy,R=d.aliases,k=[],E=t.clone().removeAll(),x=E.clone(),w=E.clone(),P=E.clone(),A=Array.prototype.reduce.call(t.nodes,(function(e,r){if("decl"===r.type){var o=r;e[o.prop]=o.value.trim()}return e}),{}),T=[],M=!1,j={};B(t,["decl"],(function(r,t){if(q(r.next()),r.remove(),t.directive===s.RAW&&t.option){var n=G(j,a),i=e.parse(t.option);c===o.combined&&!n||n&&(c===o.combined&&n===u||c===o.override&&n!==u)?x.append(i.nodes):E.append(i.nodes)}C(t,j)||(j[t.directive]=t)}),(function(t){if(!F(j,s.IGNORE)){var i=F(j,s.RENAME),l=t,d=l.toString()+";",N=r.process(d,{processUrls:m||i,processEnv:b,useCalc:g,stringMap:v,autoRename:h!==n.disabled,autoRenameStrict:h===n.strict,greedy:y,aliases:R}),S=e.parse(N).first;S.source=l.source,S.raws=l.raws;var I=l.prop.trim(),C=U(I),B=l.value.trim(),L="animation"===C||"animation-name"===C,$=S.prop.trim(),W=S.value.trim(),K=Z[C],D=T.includes(C)||!!K&&K.some((function(e){return T.indexOf(e)>=0})),z=function(e,r){return r.some((function(r){return Z[r]&&Z[r].includes(e)}))}(C,T),H=!!p&&!!ee[C],_=G(j,a),q=!_||_===u||c===o.diff;if(I!==$||B!==W||D||z||H||L)if(L)if(I!==$||B!==W||0!==O.keyframes.length&&O.keyframesRegExp.test(B)){var J=l.value.replace(O.keyframesRegExp,(function(e,r,o,t){return r+O.keyframesStringMap[o].name+t})),Q=l.value.replace(O.keyframesRegExp,(function(e,r,o,t){return r+O.keyframesStringMap[o].nameFlipped+t})),V=l.clone();if(c===o.combined)(X=l.clone()).value=J,V.value=Q,q?(E.append(X),x.append(V)):(E.append(V),x.append(X)),k.push(l);else l.value=J,V.value=Q,q?E.append(V):x.append(V),p&&c!==o.diff&&(te(l,P),k.push(l))}else p&&!ne(l)&&(c===o.diff?te(l,E):te(l,P),k.push(l));else{if(I===$&&B===W)return void((D||H||z)&&!ne(l)&&(c===o.diff?te(l,E):te(l,D||z?w:P),k.push(l)));if(A[S.prop]===W)return M=!0,void(H&&!ne(l)&&(c===o.diff?te(l,E):te(l,P),k.push(l)));if(c===o.combined)q?(te(l,E),x.append(S)):(te(l,x),E.append(S)),k.push(l);else{var X;if(f.test(l.prop)&&!A[S.prop])(X=l.clone()).value=re[l.prop]||"unset",q?E.append(X):x.append(X);H&&!ne(l)&&c!==o.diff&&(te(l,P),k.push(l)),q?E.append(S):x.append(S)}T.push(C)}}})),k.length&&k.forEach((function(e){return e.remove()})),E.nodes.length||x.nodes.length||w.nodes.length||P.nodes.length?i?_(t,E,x,w,P):H(t,E,x,w,P):h===n.disabled||M||l?c!==o.diff||l||O.rulesToRemove.push(t):O.rulesAutoRename.push(t)},ae=function(e){O.options.mode===o.diff&&O.rulesToRemove.push(e)},se=function(r,n,i){void 0===n&&(n=void 0),void 0===i&&(i=!1);var a={},l=O.options,d=l.mode,c=l.source,u=l.ltrPrefix,f=l.rtlPrefix;B(r,["rule"],(function(r,n){if(n.directive===s.RAW&&n.option){var i=G(a),l=e.parse(n.option);return d!==o.diff&&l.walkRules((function(e){W(e,!i&&c===t.ltr||i&&i===t.ltr?f:u)})),void r.replaceWith(l.nodes)}q(r.next()),r.remove(),C(n,a)||(a[n.directive]=n)}),(function(e){if(F(a,s.IGNORE))ae(e);else{var r=e,o=G(a,n);F(a,s.RENAME)?K(r)?ae(r):(O.rulesAutoRename.push(r),ie(r,i,o,!0)):K(r)?ae(r):ie(r,i,o),se(r,n,!0)}}))},le=function(e){var r={};B(e,["atrule","rule"],(function(e,o){C(o,r)||(r[o.directive]=o)}),(function(e){if(!F(r,s.IGNORE)&&"atrule"===e.type){var o=e;if("keyframes"!==U(o.name)){var t=G(r);se(o,t),le(o)}}}))},de=function(e){O.options.mode===o.diff&&O.keyframesToRemove.push(e)};function ce(i){return void 0===i&&(i={}),{postcssPlugin:"postcss-rtlcss",Once:function(a){M(i),function(o){var n=O.options,i=n.source,a=n.processUrls,l=n.useCalc,d=n.stringMap;if(n.processKeyFrames){var c={};B(o,["atrule","rule"],(function(e,r){C(r,c)||(c[r.directive]=r)}),(function(o){if(F(c,s.IGNORE))de(o);else if("atrule"===o.type){var n=o;if("keyframes"===U(n.name)){var u=n.toString(),f=r.process(u,{processUrls:a,useCalc:l,stringMap:d});if(u!==f){var p=e.parse(f).first,m=n.params,b=m+"-"+t.ltr,g=m+"-"+t.rtl,v=G(c);n.params=!v&&i===t.ltr||v&&v===t.ltr?b:g,p.params=!v&&i===t.ltr||v&&v===t.ltr?g:b,O.keyframes.push({atRuleParams:m,atRule:n,atRuleFlipped:p})}else de(n)}}})),j()}}(a),le(a),se(a),O.rules.forEach((function(e){var r=e.rule,o=e.ruleLTR,t=e.ruleRTL,n=e.ruleBoth,i=e.ruleSafe;n&&n.nodes.length&&r.after(n),t&&t.nodes.length&&r.after(t),o&&o.nodes.length&&r.after(o),i&&i.nodes.length&&r.after(i),Q(r),J(r,o,t,n,i)})),O.keyframes.forEach((function(e){var r=e.atRule,o=e.atRuleFlipped;r.after(o),J(r,o)})),function(){if(O.rulesAutoRename.length){var e=O.options.stringMap.reduce((function(e,r){var o="string"==typeof r.search?[r.search]:r.search,t="string"==typeof r.replace?[r.replace]:r.replace;return o.forEach((function(r,o){e[r]=t[o],e[t[o]]=r})),e}),{}),r=Object.keys(e).join("|"),t=O.options.greedy?new RegExp("("+r+")","g"):new RegExp("\\b("+r+")\\b","g"),i={},a=[];O.rulesAutoRename.forEach((function(e){var r=!1;e.selectors.forEach((function(e){t.test(e)&&(i[e]=!0,r=!0),t.lastIndex=0})),r?a.push(e):O.options.mode===o.diff&&O.rulesToRemove.push(e)})),a.forEach((function(r){var a=r.selectors.join("|");r.selectors=r.selectors.map((function(r){var o=r.replace(t,(function(r,o){return e[o]}));return O.options.autoRename!==n.strict||O.options.autoRename===n.strict&&i[o]?o:r})),r.selectors.join("|")===a&&O.options.mode===o.diff&&O.rulesToRemove.push(r)}))}}(),function(e){var r=O.options,t=O.rules,n=O.rulesToRemove,i=O.keyframes,a=O.keyframesToRemove,s=r.mode,l=r.processKeyFrames;s===o.diff&&(t.forEach((function(e){e.rule.remove()})),n.forEach((function(e){e.remove()})),i.forEach((function(e){e.atRule.remove()})),a.forEach((function(e){e.remove()}))),e.walk((function(r){if(s===o.diff&&("comment"===r.type?r.remove():"atrule"!==r.type||l||"keyframes"!==U(r.name)||r.remove()),("rule"===r.type||"atrule"===r.type)&&r.nodes)if(D(r)){var t=r.prev();t?"comment"!==t.type&&q(r):q(r,r.parent===e?"":"\n")}else r.remove()}))}(a)}}}ce.postcss=!0;export{ce as default};
